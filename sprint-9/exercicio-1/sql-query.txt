CREATE TABLE tb_cliente (
	idCliente int primary key,
	nomeCliente varchar(100),
	cidadeCliente varchar(40),
	estadoCliente varchar(40),
	paisCliente varchar(40),
	FOREIGN KEY (idCliente) REFERENCES tb_locacao(idCliente)
)

CREATE TABLE tb_carro (
	idCarro int primary key,
	kmCarro int,
	classiCarro varchar(50),
	marcaCarro varchar(80),
	modeloCarro varchar(80),
	anoCarro int,
	idCombustivel int,
	FOREIGN KEY (idCarro) REFERENCES tb_locacao(idCarro)
)

CREATE TABLE tb_combustivel (
	idCombustivel int primary key,
	tipoCombustivel varchar(20),
	FOREIGN KEY (idCombustivel) REFERENCES tb_carro(idCombustivel)
)

CREATE TABLE tb_vendedor (
	idVendedor int primary key,
	nomeVendedor varchar(15),
	sexoVendedor smallint,
	estadoVendedor varchar(40),
	FOREIGN KEY (idVendedor) REFERENCES tb_locacao(idVendedor)
)

CREATE TABLE tb_dataloc (
	idLocacao int primary key,
	dataLocacao DATETIME,
	horaLocacao TIME,
	qtdDiaria INT,
	vlrDiaria DECIMAL(18,2),
	dataEntrega DATE,
	horaEntrega TIME,
	FOREIGN KEY (idLocacao) REFERENCES tb_locacao(idLocacao)	
)

INSERT INTO tb_cliente (idCliente, nomeCliente, cidadeCliente, estadoCliente, paisCliente)
SELECT DISTINCT idCliente, nomeCliente, cidadeCliente, estadoCliente, paisCliente
FROM tb_locacao;

INSERT INTO tb_combustivel (idCombustivel, tipoCombustivel)
SELECT DISTINCT idCombustivel, tipoCombustivel
FROM tb_locacao;

INSERT OR IGNORE INTO tb_carro (idCarro, kmCarro, classiCarro, marcaCarro, modeloCarro, anoCarro, idCombustivel)
SELECT lc.idCarro, lc.kmCarro, lc.classiCarro, lc.marcaCarro, lc.modeloCarro, lc.anoCarro, c.idCombustivel
FROM tb_locacao lc
JOIN tb_combustivel c ON lc.idCombustivel = c.idCombustivel;

INSERT INTO tb_carro (idCombustivel)
SELECT DISTINCT idCombustivel 
FROM tb_combustivel; 

INSERT INTO tb_vendedor (idVendedor, nomeVendedor, sexoVendedor, estadoVendedor)
SELECT DISTINCT idVendedor, nomeVendedor, sexoVendedor, estadoVendedor
FROM tb_locacao;

INSERT INTO tb_dataloc (idLocacao, dataLocacao, horaLocacao, qtdDiaria, vlrDiaria, dataEntrega, horaEntrega)
SELECT DISTINCT idLocacao, dataLocacao, horaLocacao, qtdDiaria, vlrDiaria, dataEntrega, horaEntrega
FROM tb_locacao

ALTER TABLE tb_locacao DROP COLUMN nomeCliente
ALTER TABLE tb_locacao DROP COLUMN estadoCliente
ALTER TABLE tb_locacao DROP COLUMN paisCliente
ALTER TABLE tb_locacao DROP COLUMN kmCarro
ALTER TABLE tb_locacao DROP COLUMN classiCarro
ALTER TABLE tb_locacao DROP COLUMN marcaCarro
ALTER TABLE tb_locacao DROP COLUMN modeloCarro
ALTER TABLE tb_locacao DROP COLUMN anoCarro
ALTER TABLE tb_locacao DROP COLUMN idCombustivel
ALTER TABLE tb_locacao DROP COLUMN tipoCombustivel
ALTER TABLE tb_locacao DROP COLUMN nomeVendedor
ALTER TABLE tb_locacao DROP COLUMN sexoVendedor
ALTER TABLE tb_locacao DROP COLUMN estadoVendedor
ALTER TABLE tb_locacao DROP COLUMN cidadeCliente
ALTER TABLE tb_locacao DROP COLUMN dataLocacao
ALTER TABLE tb_locacao DROP COLUMN horaLocacao
ALTER TABLE tb_locacao DROP COLUMN qtdDiaria
ALTER TABLE tb_locacao DROP COLUMN vlrDiaria
ALTER TABLE tb_locacao DROP COLUMN dataEntrega
ALTER TABLE tb_locacao DROP COLUMN horaEntrega