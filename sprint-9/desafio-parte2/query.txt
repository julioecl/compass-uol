select 
    csv.titulooriginal,
    tmdb.orcamento,
    tmdb.renda,
    tmdb.idiomaoriginal,
    round((tmdb.lucropordolarinvestido),2) as lucropordolarinvestido 
from desafio.csv as csv
left join desafio.tmdb as tmdb on csv.id = tmdb.imdbid
order by lucropordolarinvestido desc
limit 30

WITH decadas AS (
    SELECT
    CASE
        WHEN cast(anolancamento as int) BETWEEN 1950 AND 1959 THEN '1940s'
        WHEN cast(anolancamento as int) BETWEEN 1950 AND 1959 THEN '1950s'
        WHEN cast(anolancamento as int) BETWEEN 1960 AND 1969 THEN '1960s'
        WHEN cast(anolancamento as int) BETWEEN 1970 AND 1979 THEN '1970s'
        WHEN cast(anolancamento as int) BETWEEN 1980 AND 1989 THEN '1980s'
        WHEN cast(anolancamento as int) BETWEEN 1990 AND 1999 THEN '1990s'
        WHEN cast(anolancamento as int) BETWEEN 2000 AND 2009 THEN '2000s'
        WHEN cast(anolancamento as int) BETWEEN 2010 AND 2019 THEN '2010s'
        WHEN cast(anolancamento as int) BETWEEN 2020 AND 2029 THEN '2020s'
        ELSE null
    END AS decada
FROM desafio.csv
WHERE cast(anolancamento as int) >= 1940
)